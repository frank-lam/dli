# 执行流程<a name="dli_01_0383"></a>

FASTQ文件到VCF文件的内部执行流程可参考[图1](#fig14720530102016)，分为三个步骤：

**图 1**  执行流程<a name="fig14720530102016"></a>  
![](figures/执行流程.png "执行流程")

1.  FASTQ文件转为未对齐的BAM文件，采用GATK工具包的FastqToSam \(Picard\)方法，具体介绍请参考：

    [https://software.broadinstitute.org/gatk/documentation/tooldocs/current/picard\_sam\_FastqToSam.php](https://software.broadinstitute.org/gatk/documentation/tooldocs/current/picard_sam_FastqToSam.php)

    目前已有的默认配置项如[表1](#table56408147518)所示：

    **表 1**  配置项说明

    <a name="table56408147518"></a>
    <table><tbody><tr id="row369211419518"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p116921414859"><a name="p116921414859"></a><a name="p116921414859"></a>配置项</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p176922143515"><a name="p176922143515"></a><a name="p176922143515"></a>默认值</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p1369219141052"><a name="p1369219141052"></a><a name="p1369219141052"></a>说明</p>
    </td>
    </tr>
    <tr id="row56921141155"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p176921714958"><a name="p176921714958"></a><a name="p176921714958"></a>RG</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p17692814450"><a name="p17692814450"></a><a name="p17692814450"></a>A</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p66921214652"><a name="p66921214652"></a><a name="p66921214652"></a>读取组的名称</p>
    </td>
    </tr>
    <tr id="row14692171417512"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p16692161420511"><a name="p16692161420511"></a><a name="p16692161420511"></a>SM</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p669201411510"><a name="p669201411510"></a><a name="p669201411510"></a>SM1</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p36926141252"><a name="p36926141252"></a><a name="p36926141252"></a>样本名称，将写入BAM文件头中</p>
    </td>
    </tr>
    <tr id="row36921114658"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p969220141753"><a name="p969220141753"></a><a name="p969220141753"></a>PL</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p769212141955"><a name="p769212141955"></a><a name="p769212141955"></a>illumina</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p10692191412514"><a name="p10692191412514"></a><a name="p10692191412514"></a>平台类型，将写入BAM文件头中</p>
    </td>
    </tr>
    <tr id="row16692214859"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p206927143517"><a name="p206927143517"></a><a name="p206927143517"></a>SO</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p269213147514"><a name="p269213147514"></a><a name="p269213147514"></a>queryname</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p1769211419515"><a name="p1769211419515"></a><a name="p1769211419515"></a>BAM文件的排序方式.</p>
    </td>
    </tr>
    <tr id="row19692141419511"><td class="cellrowborder" valign="top" width="14.000000000000002%"><p id="p1269212142510"><a name="p1269212142510"></a><a name="p1269212142510"></a>MR</p>
    </td>
    <td class="cellrowborder" valign="top" width="18%"><p id="p166921914058"><a name="p166921914058"></a><a name="p166921914058"></a>200000</p>
    </td>
    <td class="cellrowborder" valign="top" width="68%"><p id="p1269218141759"><a name="p1269218141759"></a><a name="p1269218141759"></a>每个BAM文件中包含的记录数。</p>
    </td>
    </tr>
    </tbody>
    </table>

2.  未对齐的BAM文件转为对齐BAM文件，采用GATK工具包的BwaSpark方法，具体介绍请参考：

    [https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org\_broadinstitute\_hellbender\_tools\_spark\_bwa\_BwaSpark.php](https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_spark_bwa_BwaSpark.php)

3.  对齐BAM文件转为VCF文件，采用GATK工具包的ReadsPipelineSpark方法，具体介绍请参考：

    [https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org\_broadinstitute\_hellbender\_tools\_spark\_pipelines\_ReadsPipelineSpark.php](https://software.broadinstitute.org/gatk/documentation/tooldocs/current/org_broadinstitute_hellbender_tools_spark_pipelines_ReadsPipelineSpark.php)


